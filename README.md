# Note Magazine 画像スクレイパー

Note.comの雑誌記事から画像を自動でダウンロードするコマンドラインツールです。

## 機能

- 📚 **雑誌記事取得**: 指定された雑誌IDからすべての記事を自動取得
- 🖼️ **画像ダウンロード**: 記事内の画像を一括ダウンロード
- 📁 **自動フォルダ作成**: 記事タイトルに基づいて整理されたフォルダ構造を作成
- � **ZIP圧縮**: 各記事を個別のZIPファイルに圧縮して保存
- �🔢 **ボリューム番号対応**: 記事タイトルから巻数・話数を自動抽出
- ⚡ **高速ダウンロード**: 非同期処理による効率的なダウンロード
- 📊 **進捗バー**: ダウンロード進捗をリアルタイム表示
- 🔄 **重複防止**: 既存ファイルのチェックで重複ダウンロードを防止
- 🎯 **柔軟なオプション**: 様々なカスタマイズオプションを提供

## 必要条件

- **Node.js**: v18.0.0 以上
- **Bun**: JavaScriptランタイムおよびパッケージマネージャー

## インストール

1. リポジトリをクローンまたはダウンロード
2. 依存関係をインストール

```bash
bun install
```

## 使用方法

### 基本的な使用方法

```bash
bun run index.js --magazineId=<雑誌ID>
```

**例:**
```bash
bun run index.js --magazineId=<雑誌ID>
```

### オプション

| オプション | 説明 | デフォルト値 |
|-----------|------|-------------|
| `--magazineId` | **必須**: ダウンロード対象の雑誌ID | - |
| `--volume-only` | フォルダ名をボリューム番号のみに制限 | `false` |
| `--volume-digits` | ボリューム番号の桁数（整数のみ） | `2` |
| `--zip` | 各記事をZIPファイルに圧縮して保存 | `false` |

### 使用例

#### 1. 基本ダウンロード
```bash
bun run index.js --magazineId=mc2e1d995acf5
```
- 雑誌ID `mc2e1d995acf5` のすべての記事から画像をダウンロード
- フォルダ名は記事タイトルそのまま

#### 2. ボリューム番号のみ表示
```bash
bun run index.js --magazineId=mc2e1d995acf5 --volume-only
```
- フォルダ名を `第01巻`、`第02話` などのボリューム番号のみに制限
- 整数・小数両対応（例: `第1.5巻`）

#### 3. ボリューム桁数指定
```bash
bun run index.js --magazineId=mc2e1d995acf5 --volume-only --volume-digits=3
```
- ボリューム番号を3桁でゼロ埋め（例: `第001巻`、`第002話`）

#### 4. ZIP圧縮モード
```bash
bun run index.js --magazineId=mc2e1d995acf5 --zip
```
- 各記事を個別のZIPファイルに圧縮して保存
- フォルダ名.zip形式で保存（例: `第01巻.zip`）

#### 5. ZIP + ボリューム番号のみ
```bash
bun run index.js --magazineId=mc2e1d995acf5 --zip --volume-only --volume-digits=3
```
- ZIP圧縮 + ボリューム番号のみ + 3桁ゼロ埋め
- 結果: `第001巻.zip`、`第002話.zip` など

## 出力構造

### 通常モード（フォルダ作成）
ダウンロードされた画像は以下の構造で保存されます：

```
downloads/
└── <雑誌ID>/
    ├── <記事タイトル1>/
    │   ├── 001.jpg
    │   ├── 002.jpg
    │   └── ...
    ├── <記事タイトル2>/
    │   ├── 001.jpg
    │   └── ...
    └── ...
```

### ZIP圧縮モード
各記事が個別のZIPファイルに圧縮されて保存されます：

```
downloads/
└── <雑誌ID>/
    ├── <記事タイトル1>.zip
    ├── <記事タイトル2>.zip
    └── ...
```

ZIPファイル内の構造：
```
<記事タイトル1>.zip
├── 001.jpg
├── 002.jpg
└── ...
```

### ボリュームのみモードの場合

#### 通常モード
```
downloads/
└── <雑誌ID>/
    ├── 第01巻/
    │   ├── 001.jpg
    │   └── ...
    ├── 第02巻/
    │   ├── 001.jpg
    │   └── ...
    └── ...
```

#### ZIPモード
```
downloads/
└── <雑誌ID>/
    ├── 第01巻.zip
    ├── 第02巻.zip
    └── ...
```

## サポートされるボリュームパターン

ボリュームのみモードでは、以下の形式のタイトルから自動で番号を抽出します：

- `第1巻` → `第01巻`（デフォルト2桁）
- `第1.5巻` → `第1.5巻`（小数はそのまま）
- `第1話` → `第01話`
- `1巻` → `第01巻`（「第」がない場合は自動追加）
- `2話` → `第02話`

## 注意事項

### 利用規約
- このツールは個人利用を目的としています
- Note.comの利用規約を遵守してください
- 過度なリクエストは控えめに使用してください

### 技術的な注意
- ネットワーク接続が必要です
- 大量の画像ダウンロード時は時間がかかる場合があります
- ZIPモードではメモリ使用量が増加する可能性があります
- 一時的なネットワークエラー時は自動リトライします（最大3回）

### エラーハンドリング
- API制限に遭遇した場合は自動的に待機します
- ダウンロード失敗時はエラーメッセージを表示します
- 既存ファイルは自動的にスキップされます

## トラブルシューティング

### ダウンロードが始まらない場合
1. 雑誌IDが正しいか確認してください
2. インターネット接続を確認してください
3. Note.comのサービス状況を確認してください

### 画像がダウンロードされない場合
1. 対象の記事に画像が含まれているか確認してください
2. ネットワーク接続を確認してください
3. 一時的なエラーの場合は再度実行してください

### ボリューム番号が正しく表示されない場合
1. 記事タイトルに「第○○巻」または「第○○話」の形式が含まれているか確認してください
2. `--volume-only` オプションを使用しているか確認してください

## 開発情報

### 依存関係
- `archiver`: ZIPファイル作成ライブラリ
- `undici`: HTTPクライアント（ブラウザ互換ヘッダー対応）
- `cli-progress`: コマンドライン進捗バー
- `minimist`: CLI引数パーサー

### アーキテクチャ
- ES modulesを使用
- 非同期処理による効率的なダウンロード
- レート制限対策を実装
- エラーハンドリングとリトライ機能

## ライセンス

このプロジェクトは個人利用を目的としたものです。Note.comの利用規約を遵守してください。

## 貢献

バグ報告や機能改善の提案は歓迎します。プルリクエストをお待ちしています。

## AI
このアプリケーションはGrok Code Fast 1を使用して作成しました。